l **Cache原理和优化方法**

**（1）主存分块：**主存物理地址=块号+块内地址（划分方式可选，块为主存与cache交换的基本单位）

![](file:///C:\Users\mi\AppData\Local\Temp\ksohtml14008\wps1.jpg) 

组匹配（cache块号）+行对应（tag和valid）+ block匹配（块内地址）

（1）**全相联映射：**cache块与内存块随机匹配，标记位较长，搜索效率低（适合小容量cache）

（2）**组相联映射：**cache组内有多块（按组号匹配），组内块随机匹配

（3）**直接映射:** 相当于一路组相联映射，可能会冲突不命中——交替使用映射到同一cacheline数据的情况，频繁替换cacheline影响性能;

**行替换策略：**

随机替换、最不常使用替换、最近最少使用替换

l **提升cache性能的方法：**

**平均访存时间：**命中访问时间 + 失效率* 失效开销

[https://zhuanlan.zhihu.com/p/346909640](https://zhuanlan.zhihu.com/p/346909640)

Cache较大可以提高命中率，但命中时间会增加，一般约接近cpuc的cache容量越小

Cache块越大，有利于空间局部性好的程序，但行数会减少，对时间局部性好的程序不利，而且cache不命中时块越大损失也大

（1）强制失效（**数据预取**）容量失效（**增大cache容量**）冲突失效（**增加相联路数**）

（2）**写缓冲**（缓冲区写到主存和cpu执行其他指令能并行）**写合并**（缓冲区已包含需要读入主存的块，则将两者合并）